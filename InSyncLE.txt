# InSyncLE
# Drew Griffith

#hint: Mean Reversion ENTRY Strategy. The default inputs are based on stocks that are more volatile in nature. If you prefer to trade less volatile stocks, you should lower the extremeties input. This strategy looks for long term trending stocks above EMA300, SMA200 or linearregressionslope; Also, there are additional filters in place to ensure a better entry signal. The strategy is based on closing prices of the day of signal, so buy as close to the EOD as possible. The target is the high price of the day of entry. Ideal hold times are less than 5 days. On day 5, the position moves to breakeven. Optimized for use on daily charts.

declare upper;

input BubbleOn = yes;
input extremities = 1.5; #percentage
def ema_length = 300;
def bb_length = 20;
def rsi2_length = 2;
input rsi2_oversold = 5;
def rsi14_length = 12;
def mfi_length = 14;
def bmp_length = 14;
def mdvl = 0.4;

## Does stock meet indicator requirements? (no shorting)
def bbCalc = BollingerPercentB(length = bb_length);
def rsi2 = RSI(length = rsi2_length);
def rsi14 = RSI(length = rsi14_length);
def mf = MoneyFlowIndex(length = mfi_length);
def bomp = BalanceOfMarketPower(length = bmp_length);

# Does stock meet ANY long term trend filters?
def ema = close > MovAvgExponential(length = ema_length);

# Does stock meet "bar" components?
def mdv = ((high - close) / (.001 + high - low) >= mdvl); ## long candle; close below midbody
def ext = ((high / close - 1) * 100) >= extremities; ## high/low must be greater than n pct from close
def gap = close <= close[1] and high > low[1]; ## do NOT trade against a gap

def signal1 = (ema)
  and mdv and ext #and gap
  and bbCalc < 5
  and rsi2 < rsi2_oversold
  and rsi14 < 40
  and mf < 35
  and bomp < 0;
def signal2 = (!ema)
  and mdv and ext #and gap
  and bbCalc < 5
  and rsi2 < rsi2_oversold
  and rsi14 < 30
  and mf < 30
  and bomp < 0;

## Plots
plot LE = if signal1 then 2 else if signal2 then 1 else 0;
LE.AssignValueColor(if signal1 then Color.GREEN else if signal2 then Color.CYAN else Color.GRAY);
LE.SetPaintingStrategy(PaintingStrategy.BOOLEAN_ARROW_UP);
LE.SetLineWeight(5);
AddChartBubble(BubbleOn and signal1, low, "Insync > EMA300", Color.GREEN, no);
AddChartBubble(BubbleOn and signal2, low, "Insync < EMA300", Color.CYAN, no);

## Needed for Watchlist box painting
#AssignBackgroundColor(if signal1 then Color.GREEN else if signal2 then Color.CYAN else Color.GRAY);
